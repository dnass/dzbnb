{% extends "bnb/base.html" %}
{% block title %}DZBNB: Homepage{% endblock %}
{% block content %}
<h1>Welcome {{ bnbuser.user.first_name }} {{ bnbuser.user.last_name }}</h1>
<h2><a href="{% url 'bnbuser_details' bnbuser.id %}">Manage my properties</a></h2>
{% if recently_added_properties %}
<h2>Recently added properties</h2>
<table width="80%" class="table-bordered">
  <tr>
    <th scope="col">Name</th>
    <th scope="col">Owner</th>
    <th scope="col">Size</th>
    <th scope="col">Price</th>
  </tr>
{% for p in recently_added_properties %}
  <tr>
    <td><a href="{% url 'property_details' p.id %}">{{ p.name }}</a></td>
    <td><a href="{% url 'bnbuser_details' p.owner.id %}">{{ p.owner.user.first_name }} {{ p.owner.user.last_name }}</td>
    <td>{{ p.size }}</td>
    <td>{{ p.price }}</td>
  </tr>
{% endfor %}
</table>
{% else %}
<h2>There are no new properties to display.</h2>
{% endif %}
{% if reservation_requests %}
<h2>Unapproved reservation requests</h2>
<table width="80%" class="table-bordered">
  <tr>
    <th scope="col">Property name</th>
    <th scope="col">Requested by</th>
    <th scope="col">Start date</th>
    <th scope="col">End date</th>
    <th scope="col"></th>
  </tr>
{% for r in reservation_requests %}
  <tr>
    <td><a href = "{% url 'property_details' r.propertie.id %}">{{ r.propertie.name }}</a></td>
    <td><a href = "{% url 'bnbuser_details' r.renter.id %}">{{ r.renter.user.first_name }} {{ r.renter.user.last_name }}</a></td>
    <td>{{ r.start_date }}</td>
    <td>{{ r.end_date }}</td>
    <td><a href="{% url 'approve_reservation' r.id %}">Approve?</a></td>
{% endfor %}
  </tr>
</table>
{% else %}
<h2>You have no new reservation requests.</h2>
{% endif %}
{% endblock %}